<form class="primary-form-control" [formGroup]="createCustomerForm">

   <div class="row mb-4">
    <div class="col-12">
      <div class="profile-picture-container">
        <div class="profile-picture-wrapper">
          <div class="profile-picture-circle">
            <img [src]="profileImage || '../../assets/images/default-profile.png'" alt="Profile Picture" class="profile-image">
            <div *ngIf="formMode !== 'view'" class="edit-options">
              <label for="profileImageUpload" class="edit-icon">
                <i class="fas fa-pencil-alt"></i>
                <input id="profileImageUpload" type="file" (change)="onFileSelected($event)" accept="image/*" style="display: none;">
              </label>
              <button type="button" class="edit-icon webcam-icon" (click)="openWebcamDialog()">
                <i class="fas fa-camera"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="trainer-name">Branch</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('branchId')?.invalid && createCustomerForm.get('branchId')?.touched}">
          <p-select class="form-control primary-p-select"
          [options]="branchOptions" dataKey="_id"
          formControlName="branchId"
          optionLabel="bch_Name" optionValue="_id"
          placeholder="Select a Branch"/>
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="formMode == 'view'" [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-code">Code</label>
        <input type="text" class="form-control" id="customer-code" formControlName="ctr_Code" [readOnly]="true" placeholder="CTR000000000">
      </div>
    </div>
    
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-name">Name</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_Name')?.invalid && createCustomerForm.get('ctr_Name')?.touched}">
          <input type="text" class="form-control" id="customer-name" formControlName="ctr_Name" placeholder="ex: Hammer">
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-mobile-no">Mobile No</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_MobileNo')?.invalid && createCustomerForm.get('ctr_MobileNo')?.touched}">
          <input type="tel" id="customer-mobile-no" pattern="[0-9]{10}" class="form-control" formControlName="ctr_MobileNo" placeholder="(+000) 000000000">
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-whatsapp-no">WhatsApp No</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_WhatsAppNo')?.invalid && createCustomerForm.get('ctr_WhatsAppNo')?.touched}">
          <input type="tel" id="customer-whatsapp-no" pattern="[0-9]{10}" class="form-control" formControlName="ctr_WhatsAppNo" placeholder="(+000) 000000000">
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-Height">Height</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_Height')?.invalid && createCustomerForm.get('ctr_Height')?.touched}">
          <input type="number" id="customer-Height" class="form-control" formControlName="ctr_Height" placeholder="ex: 130 cm">
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-Weight">Weight</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_Weight')?.invalid && createCustomerForm.get('ctr_Weight')?.touched}">
          <input type="number" id="customer-Weight" class="form-control" formControlName="ctr_Weight" placeholder="ex: 80 kg">
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-email">Email</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_Email')?.invalid && createCustomerForm.get('ctr_Email')?.touched}">
          <input type="email" id="customer-email" class="form-control" formControlName="ctr_Email" placeholder="ex: hammer@example.com">
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-dob">DOB</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_Dob')?.invalid && createCustomerForm.get('ctr_Dob')?.touched}">
          <p-datepicker class="primary-p-datepicker form-control" id="customer-dob" formControlName="ctr_Dob" placeholder="dd-mm-yyyy" dateFormat="dd-mm-yy" appendTo="body"/>
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
    <div [ngClass]="{'col-xl-3 col-lg-4 col-sm-6 col-12': formMode == 'view', 'col-12': formMode != 'view'}">
      <div class="pt-1">
        <label class="form-label" for="customer-address">Address</label>
        <div [ngClass]="{'form-validation-error': createCustomerForm.get('ctr_Addresses')?.invalid && createCustomerForm.get('ctr_Addresses')?.touched}">
          <textarea name="" id="customer-address" class="form-control" style="width: 100%;" formControlName="ctr_Addresses" placeholder="Address"></textarea>
          <div class="form-validation-msg">
            <span>Required</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>

<div *ngIf="showWebcamDialog" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-header">
      <h5>Take a Photo</h5>
      <button type="button" class="close-btn" (click)="closeWebcamDialog()">&times;</button>
    </div>
    <div class="modal-body">
      <div class="webcam-container">
        <video #videoElement autoplay playsinline class="webcam-video"></video>
        <canvas #canvasElement class="webcam-canvas"></canvas>
      </div>
      <div class="webcam-controls">
        <button type="button" class="btn btn-primary" (click)="captureImage()" [disabled]="!isWebcamReady">
          <i class="fas fa-camera"></i> Capture
        </button>
        <button type="button" class="btn btn-secondary" (click)="retryCapture()" *ngIf="capturedImage">
          <i class="fas fa-redo"></i> Retry
        </button>
        <button type="button" class="btn btn-success" (click)="useCapturedImage()" *ngIf="capturedImage">
          <i class="fas fa-check"></i> Use This Photo
        </button>
      </div>
    </div>
  </div>
</div>
